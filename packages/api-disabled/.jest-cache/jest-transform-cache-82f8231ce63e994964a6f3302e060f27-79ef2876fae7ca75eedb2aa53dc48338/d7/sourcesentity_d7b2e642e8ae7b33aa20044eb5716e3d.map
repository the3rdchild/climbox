{"file":"/home/user/climbox/packages/api/src/sites/sources.entity.ts","mappings":";;;;;;;;;;;;AAAA,6CAA8C;AAC9C,qCAMiB;AACjB,+FAAkF;AAClF,iDAAsC;AACtC,iEAAwD;AAOjD,IAAM,OAAO,GAAb,MAAM,OAAO;CAqBnB,CAAA;AApBC;IAAC,IAAA,qBAAW,EAAC,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC;IAC3B,IAAA,gCAAsB,GAAE;;mCACd;AAEX;IAAC,IAAA,mBAAS,EAAC,GAAG,EAAE,CAAC,mBAAI,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE,CAAC;8BACzC,mBAAI;qCAAC;AAEX;IAAC,IAAA,mBAAS,EAAC,GAAG,EAAE,CAAC,2CAAe,EAAE,EAAE,QAAQ,EAAE,SAAS,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;4CACtC;AAEpC;IAAC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,6BAAU,EAAE,CAAC;;qCAC1B;AAEjB;IAAC,IAAA,qBAAW,EAAC,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC;IAC5B,IAAA,gBAAM,EAAC,OAAO,EAAE,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;sCACf;AAErB;IAAC,IAAA,qBAAW,EAAC,EAAE,OAAO,EAAE,WAAW,EAAE,CAAC;IACrC,IAAA,gBAAM,EAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE,mBAAmB,EAAE,CAAC;;yCAC9B;AApBb,OAAO;IALnB,IAAA,gBAAM,GAAE;IACT,8DAA8D;IAC9D,6CAA6C;IAC7C,8KAA8K;;IAC7K,IAAA,eAAK,EAAC,sBAAsB,EAAE,EAAE,WAAW,EAAE,KAAK,EAAE,CAAC;GACzC,OAAO,CAqBnB;AArBY,0BAAO","names":[],"sources":["/home/user/climbox/packages/api/src/sites/sources.entity.ts"],"sourcesContent":["import { ApiProperty } from '@nestjs/swagger';\r\nimport {\r\n  Column,\r\n  Entity,\r\n  Index,\r\n  ManyToOne,\r\n  PrimaryGeneratedColumn,\r\n} from 'typeorm';\r\nimport { SiteSurveyPoint } from '../site-survey-points/site-survey-points.entity';\r\nimport { Site } from './sites.entity';\r\nimport { SourceType } from './schemas/source-type.enum';\r\n\r\n@Entity()\r\n// Typeorm does not allow to add raw SQL on column declaration\r\n// So we will edit the query on the migration\r\n// CREATE UNIQUE INDEX \"no_duplicate_sources\" ON \"sources\" (\"site_id\", COALESCE(\"survey_point_id\", 0), \"type\", COALESCE(\"sensor_id\", 'SPOT-IMPOSSIBLE'), COALESCE(\"depth\", 0))\r\n@Index('no_duplicate_sources', { synchronize: false })\r\nexport class Sources {\r\n  @ApiProperty({ example: 1 })\r\n  @PrimaryGeneratedColumn()\r\n  id: number;\r\n\r\n  @ManyToOne(() => Site, { onDelete: 'CASCADE' })\r\n  site: Site;\r\n\r\n  @ManyToOne(() => SiteSurveyPoint, { onDelete: 'CASCADE', nullable: true })\r\n  surveyPoint: SiteSurveyPoint | null;\r\n\r\n  @Column({ type: 'enum', enum: SourceType })\r\n  type: SourceType;\r\n\r\n  @ApiProperty({ example: 12 })\r\n  @Column('float', { nullable: true })\r\n  depth: number | null;\r\n\r\n  @ApiProperty({ example: 'SPOT-0000' })\r\n  @Column({ nullable: true, type: 'character varying' })\r\n  sensorId: string | null;\r\n}\r\n"],"version":3}