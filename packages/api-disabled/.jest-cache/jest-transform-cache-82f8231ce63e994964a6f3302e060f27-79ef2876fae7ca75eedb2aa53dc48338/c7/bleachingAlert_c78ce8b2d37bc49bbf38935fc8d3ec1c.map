{"version":3,"names":["cov_254y2fdvxm","actualCoverage","s","lodash_1","require","calculateAlertLevel","maxMonthlyMean","satelliteTemperature","degreeHeatingDays","f","hotSpot","b","isNil","undefined","isNumber","inRange","exports"],"sources":["/home/user/climbox/packages/api/src/utils/bleachingAlert.ts"],"sourcesContent":["import { isNil, isNumber, inRange } from 'lodash';\r\n\r\n/**\r\n * Calculating bleaching alert level based on NOAA defintions:\r\n * available at https://coralreefwatch.noaa.gov/subscriptions/vs.php\r\n * @param maxMonthlyMean\r\n * @param satelliteTemperature\r\n * @param degreeHeatingDays\r\n */\r\nexport const calculateAlertLevel = (\r\n  maxMonthlyMean?: number | null,\r\n  satelliteTemperature?: number | null,\r\n  degreeHeatingDays?: number | null,\r\n): number | undefined => {\r\n  const hotSpot =\r\n    satelliteTemperature &&\r\n    maxMonthlyMean &&\r\n    satelliteTemperature - maxMonthlyMean;\r\n\r\n  switch (true) {\r\n    case isNil(hotSpot):\r\n      return undefined;\r\n\r\n    case isNumber(hotSpot) && hotSpot <= 0:\r\n      return 0;\r\n\r\n    case isNumber(hotSpot) && hotSpot < 1:\r\n      return 1;\r\n\r\n    // Hotspot >=1 or nil past this point, start dhw checks.\r\n    case isNil(degreeHeatingDays):\r\n      return 0;\r\n\r\n    case inRange(degreeHeatingDays!, 0, 4 * 7):\r\n      return 2;\r\n\r\n    case inRange(degreeHeatingDays!, 4 * 7, 8 * 7):\r\n      return 3;\r\n\r\n    case degreeHeatingDays! >= 8 * 7:\r\n      return 4;\r\n\r\n    default:\r\n      return undefined;\r\n  }\r\n};\r\n"],"mappings":"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"}